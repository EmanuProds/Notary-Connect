<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.tailwindcss.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' ws://localhost:3000; img-src 'self' data:; object-src 'none'; frame-ancestors 'none';">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notary Connect - Chat</title>
    <link rel="icon" href="./img/icons/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="./css/chatStyles.css">
</head>
<body>
    <div class="chat-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <img src="./img/icons/logo.svg" alt="Logo" class="logo">
                <h1>Notary Connect</h1>
            </div>
            <div class="tabs">
                <button class="tab-button active" data-tab="active">Ativos/Pendentes</button>
                <button class="tab-button" data-tab="closed">Encerrados</button>
            </div>
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Buscar conversa...">
            </div>
            <div class="conversations-list" id="conversations-list">
                <!-- Conversas serão adicionadas aqui dinamicamente -->
            </div>
            <div class="user-info">
                <div class="user-avatar">
                    <img src="./img/icons/profile.svg" alt="Avatar">
                </div>
                <div class="user-details">
                    <span id="user-name">Carregando...</span>
                    <span id="user-status">Online</span>
                </div>
                <button id="logout-button" class="logout-button">Sair</button>
            </div>
        </div>
        <div class="chat-area">
            <div class="welcome-screen" id="welcome-screen">
                <img src="./img/icons/logo.svg" alt="Logo" class="welcome-logo">
                <h2>Bem-vindo ao Notary Connect</h2>
                <p>Selecione uma conversa para começar a atender.</p>
            </div>
            <div class="chat-interface" id="chat-interface" style="display: none;">
                <div class="chat-header">
                    <div class="contact-info">
                        <div class="contact-avatar">
                            <img id="contact-avatar" src="./img/icons/profile.svg" alt="Avatar">
                        </div>
                        <div class="contact-details">
                            <span id="contact-name">Nome do Contato</span>
                            <span id="contact-number">Número do Contato</span>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button id="transfer-button" class="action-button">Transferir</button>
                        <button id="close-chat-button" class="action-button">Encerrar</button>
                    </div>
                </div>
                <div class="messages-container" id="messages-container">
                    <!-- Mensagens serão adicionadas aqui dinamicamente -->
                </div>
                <div class="input-area">
                    <button id="attachment-button" class="attachment-button">
                        <img src="./img/icons/attachment.svg" alt="Anexo">
                    </button>
                    <input type="text" id="message-input" placeholder="Digite sua mensagem...">
                    <button id="send-button" class="send-button">Enviar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de transferência -->
    <div id="transfer-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Transferir Conversa</h2>
            <div class="tabs">
                <button class="tab-button active" data-tab="sectors">Para Setor</button>
                <button class="tab-button" data-tab="attendants">Para Atendente</button>
            </div>
            <div class="tab-content" id="sectors-tab">
                <div class="sectors-list" id="sectors-list">
                    <!-- Setores serão adicionados aqui dinamicamente -->
                </div>
            </div>
            <div class="tab-content" id="attendants-tab" style="display: none;">
                <div class="attendants-list" id="attendants-list">
                    <!-- Atendentes serão adicionados aqui dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de alerta -->
    <div id="alert-modal" class="alert-modal">
        <div class="alert-content">
            <span class="close-alert">&times;</span>
            <div id="alert-message"></div>
        </div>
    </div>

    <!-- Input de arquivo oculto -->
    <input type="file" id="file-input" style="display: none;">

    <!-- Scripts -->
    <script>
        // Verificar se os recursos foram carregados corretamente
        window.addEventListener('error', function(e) {
            console.error('Erro ao carregar recurso:', e.target.src || e.target.href);
        }, true);
    </script>
    
    <!-- Carregar scripts na ordem correta -->
    <script src="./js/chatUtils.js"></script>
    <script src="./js/chatDomElements.js"></script>
    <script src="./js/notificationService.js"></script>
    <script src="./js/chatWebsocketService.js"></script>
    <script src="./js/chatUiUpdater.js"></script>
    <script src="./js/chatActions.js"></script>
    <script src="./js/chatEventHandlers.js"></script>
    <script src="./js/mainChatScript.js"></script>
</body>
</html>
