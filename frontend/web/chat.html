<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notary Connect - Atendimento</title>
    <link rel="icon" href="./img/icons/favicon.ico" type="image/x-icon">
    <link rel="icon" href="./img/icons/logo.svg" type="image/svg+xml">

    <!-- Google Fonts (Roboto) -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous" />
    <!-- Material Tailwind CSS -->
    <link rel="stylesheet" href="https://unpkg.com/@material-tailwind/html@latest/styles/material-tailwind.css" />
    
    <!-- <script src="https://cdn.tailwindcss.com"></script> --> {/* Replaced by Material Tailwind */}
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"> --> {/* Replaced Inter with Roboto */}
    
    <!-- Custom Theme CSS -->
    <link rel="stylesheet" href="./css/custom-theme.css">
    <!-- Original Chat Specific Styles -->
    <link rel="stylesheet" href="./css/chatStyles.css">

    <!-- Removed inline Tailwind config script and basic html, body styles as they should be handled by Material Tailwind / custom-theme.css -->
    <!-- 
    <script>
        // Tailwind CSS Configuration
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#007bff', 
                        'primary-darker': '#0056b3', 
                        'danger': '#dc3545',  
                        'danger-darker': '#c82333', 
                    }
                }
            }
        }
    </script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style> 
    -->
</head>
<body class="bg-gray-100 p-1 sm:p-2 md:p-4"> {/* Body classes might be adjusted by custom-theme.css or Material Tailwind defaults */}
    <div class="container mx-auto flex h-full w-full max-w-screen-2xl shadow-lg rounded-lg overflow-hidden">
        <!-- Icon Bar -->
        <div class="icon-bar w-16 bg-primary text-white flex flex-col items-center py-4 space-y-4 flex-shrink-0">
            <!-- User Profile Icon (Top) -->
            <div class="icon-bar-item user-profile-icon-container" title="Perfil do Atendente">
                <img src="./img/icons/user.svg" alt="Perfil do Atendente" class="icon-bar-icon">
            </div>

            <!-- Spacer to push chat icons down a bit if needed, or manage with flex properties -->
            <div class="flex-grow"></div>

            <!-- Pending Chats Icon -->
            <div class="icon-bar-item" data-tab="active" title="Ativos/Pendentes">
                <img src="./img/icons/chats-teardrop.svg" alt="Ativos/Pendentes" class="icon-bar-icon">
            </div>

            <!-- Closed Chats Icon -->
            <div class="icon-bar-item" data-tab="closed" title="Encerrados">
                <img src="./img/icons/archive-icon.svg" alt="Encerrados" class="icon-bar-icon">
            </div>
            
            <!-- Spacer to push agent name to bottom -->
            <div class="flex-grow"></div>

            <!-- Name of logged in agent -->
            <div class="icon-bar-agent-name p-2 text-center text-xs">
                <span id="loggedInAgentName" class="font-semibold">Atendente</span>
            </div>
        </div>

        <!-- Chat List Panel -->
        <div class="chat-list-panel w-full md:w-80 bg-white border-r border-gray-200 flex flex-col flex-shrink-0">
            <div class="sidebar-search p-3 border-b border-gray-200">
                <input type="text" id="chatSearchInput" placeholder="Buscar por nome, setor, ID..." class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary text-sm">
            </div>
            <div id="conversationsList" class="chat-list-items flex-grow overflow-y-auto">
                <div class="p-4 text-center text-gray-500">Carregando chats...</div>
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="chat-area flex-grow flex flex-col bg-gray-50">
            <div class="chat-header flex items-center justify-between p-4 bg-primary text-white h-20">
                <div id="currentChatHeader" class="chat-header-title flex items-center gap-2">
                    <img src="./img/icons/chat.svg" alt="Ícone do Chat" id="chatHeaderIcon" class="w-6 h-6 opacity-80" style="filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(200%) contrast(100%); display: none;"/>
                    <span class="font-semibold text-lg" id="chatHeaderName">Selecione um Chat</span>
                </div>
                <button id="endChatButton" class="end-chat-button bg-danger hover:bg-danger-darker text-white font-medium py-2 px-4 rounded-md flex items-center gap-2 transition duration-150 ease-in-out" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
                        <path fill-rule="evenodd" d="M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C6.55 22.5 1.5 17.45 1.5 10.5V4.5Z" clip-rule="evenodd" />
                    </svg>
                    <span>Encerrar</span>
                </button>
            </div>
            <div class="chat-messages flex-grow p-4 overflow-y-auto space-y-4 bg-gray-100" id="chatMessages">
                <div class="no-chat-selected flex flex-col items-center justify-center h-full text-gray-500">
                    <img src="./img/icons/chat.svg" alt="Selecione um chat" id="noChatSelectedIconPlaceholder" class="w-16 h-16 mb-4 text-gray-400" style="filter: invert(50%) sepia(10%) saturate(500%) hue-rotate(180deg) brightness(100%) contrast(90%);"/>
                    <p class="text-lg">Selecione um chat na lista ao lado para começar.</p>
                </div>
            </div>

            <div id="typingIndicator" class="typing-indicator px-4 pb-2 text-sm text-gray-600 italic" style="display: none;">
                Cliente está digitando...
            </div>

            <div class="chat-input-area p-3 border-t border-gray-200 bg-white flex items-center gap-2" id="chatInputControls" style="display: none;">
                <button id="attachmentButton" class="upload-button p-2 text-gray-600 hover:text-primary rounded-full hover:bg-gray-100 transition-colors" title="Enviar mídia">
                    <img src="./img/icons/attachment.svg" alt="Anexar arquivo" class="w-6 h-6" />
                </button>
                <input type="file" id="mediaUploadInput" class="hidden" accept="image/*,video/*,audio/*,application/pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt">
                <input type="text" id="messageInput" placeholder="Digite sua mensagem..." class="flex-grow px-4 py-2 border border-gray-300 rounded-md focus:ring-primary focus:border-primary text-sm">
                <button id="sendMessageButton" class="bg-primary hover:bg-primary-darker text-white font-medium py-2 px-4 rounded-md flex items-center gap-2 transition duration-150 ease-in-out">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
                        <path d="M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z" />
                    </svg>
                    <span>Enviar</span>
                </button>
            </div>
        </div>
    </div>

    <div id="connectionStatus" class="connection-status fixed bottom-4 right-4 px-4 py-2 rounded-md text-sm font-medium shadow-md z-50">Conectando...</div>
    <div id="alertModal" class="alert-modal fixed top-5 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-md shadow-lg z-[100] text-sm font-medium" style="display: none;"><span id="alertModalMessage"></span></div>

    <!-- Material Tailwind JS -->
    <script src="https://unpkg.com/@material-tailwind/html@latest/scripts/material-tailwind.js"></script>
    <!-- Original Chat Scripts -->
    <script src="./js/chatUtils.js"></script>
    <script src="./js/chatDomElements.js"></script>
    <script src="./js/chatWebsocketService.js"></script>
    <script src="./js/chatUiUpdater.js"></script>
    <script src="./js/chatActions.js"></script>
    <script src="./js/chatEventHandlers.js"></script>
    <script src="./js/mainChatScript.js"></script> 
    <script src="./js/notificationService.js"></script> 
</body>
</html>
