/* web/public/css/chatStyles.css */

/* Material Design 3 Light Theme Color Palette */
:root {
    --md-sys-color-primary: #6750A4;
    --md-sys-color-on-primary: #FFFFFF;
    --md-sys-color-primary-container: #EADDFF;
    --md-sys-color-on-primary-container: #21005D;
    --md-sys-color-secondary: #625B71;
    --md-sys-color-on-secondary: #FFFFFF;
    --md-sys-color-secondary-container: #E8DEF8;
    --md-sys-color-on-secondary-container: #1D192B;
    --md-sys-color-tertiary: #7D5260;
    --md-sys-color-on-tertiary: #FFFFFF;
    --md-sys-color-tertiary-container: #FFD8E4;
    --md-sys-color-on-tertiary-container: #31111D;
    --md-sys-color-error: #B3261E;
    --md-sys-color-on-error: #FFFFFF;
    --md-sys-color-error-container: #F9DEDC;
    --md-sys-color-on-error-container: #410E0B;
    --md-sys-color-background: #FFFBFE;
    --md-sys-color-on-background: #1C1B1F;
    --md-sys-color-surface: #FFFBFE;
    --md-sys-color-on-surface: #1C1B1F;
    --md-sys-color-surface-variant: #E7E0EC;
    --md-sys-color-on-surface-variant: #49454F;
    --md-sys-color-outline: #79747E;
    --md-sys-color-outline-variant: #CAC4D0;
    --md-sys-color-shadow: #000000;
    --md-sys-color-inverse-surface: #313033;
    --md-sys-color-inverse-on-surface: #F4EFF4;
    --md-sys-color-inverse-primary: #D0BCFF;
    --md-sys-color-surface-dim: #DED8E1; /* M3 Surface Tints */
    --md-sys-color-surface-bright: #FFFBFE;
    --md-sys-color-surface-container-lowest: #FFFFFF;
    --md-sys-color-surface-container-low: #F7F2FA;
    --md-sys-color-surface-container: #F3EDF7;
    --md-sys-color-surface-container-high: #ECE6F0;
    --md-sys-color-surface-container-highest: #E6E0E9;

    /* Layout specific variables */
    --icon-bar-bg: var(--md-sys-color-surface-container-low);
    --chat-list-panel-bg: var(--md-sys-color-surface);
    --chat-area-bg: var(--md-sys-color-background);
    --header-bg: var(--md-sys-color-surface-container-high); /* General header background */
    --header-text-color: var(--md-sys-color-on-surface-variant);
    --input-bg: var(--md-sys-color-surface-container-highest);
    --input-border-color: var(--md-sys-color-outline);
    --input-focus-border-color: var(--md-sys-color-primary);
    --button-primary-bg: var(--md-sys-color-primary);
    --button-primary-text: var(--md-sys-color-on-primary);
    --button-danger-bg: var(--md-sys-color-error);
    --button-danger-text: var(--md-sys-color-on-error);

    /* Typography */
    --font-family-sans: 'Inter', sans-serif;
    --md-sys-typescale-label-large-font-family-name: 'Inter';
    --md-sys-typescale-label-large-font-weight: 500; /* Medium */
    --md-sys-typescale-label-large-size: 0.875rem; /* 14px */
    --md-sys-typescale-body-medium-font-family-name: 'Inter';
    --md-sys-typescale-body-medium-font-weight: 400; /* Regular */
    --md-sys-typescale-body-medium-size: 0.875rem; /* 14px */
    --md-sys-typescale-body-large-font-family-name: 'Inter';
    --md-sys-typescale-body-large-font-weight: 400; /* Regular */
    --md-sys-typescale-body-large-size: 1rem; /* 16px */
    --md-sys-typescale-title-medium-font-family-name: 'Inter';
    --md-sys-typescale-title-medium-font-weight: 500; /* Medium */
    --md-sys-typescale-title-medium-size: 1rem; /* 16px */

    /* Sizing and Spacing */
    --header-height: 64px;
    --header-padding-y: 1rem;
    --header-font-size: var(--md-sys-typescale-title-medium-size);

    /* Specific Status Colors (map to M3 roles) */
    --pending-analyzed-bg: var(--md-sys-color-tertiary-container);
    --pending-analyzed-text: var(--md-sys-color-on-tertiary-container);
    --pending-analyzed-border: var(--md-sys-color-tertiary);

    --system-notification-bg: var(--md-sys-color-surface-container);
    --system-notification-text: var(--md-sys-color-on-surface-variant);
    --system-notification-border: var(--md-sys-color-outline-variant);
}

/* Material Design 3 Dark Theme Color Palette */
html[data-theme="dark"] {
    --md-sys-color-primary: #D0BCFF;
    --md-sys-color-on-primary: #381E72;
    --md-sys-color-primary-container: #4F378B;
    --md-sys-color-on-primary-container: #EADDFF;
    --md-sys-color-secondary: #CCC2DC;
    --md-sys-color-on-secondary: #332D41;
    --md-sys-color-secondary-container: #4A4458;
    --md-sys-color-on-secondary-container: #E8DEF8;
    --md-sys-color-tertiary: #EFB8C8;
    --md-sys-color-on-tertiary: #492532;
    --md-sys-color-tertiary-container: #633B48;
    --md-sys-color-on-tertiary-container: #FFD8E4;
    --md-sys-color-error: #F2B8B5;
    --md-sys-color-on-error: #601410;
    --md-sys-color-error-container: #8C1D18;
    --md-sys-color-on-error-container: #F9DEDC;
    --md-sys-color-background: #1C1B1F;
    --md-sys-color-on-background: #E6E1E5;
    --md-sys-color-surface: #1C1B1F;
    --md-sys-color-on-surface: #E6E1E5;
    --md-sys-color-surface-variant: #49454F;
    --md-sys-color-on-surface-variant: #CAC4D0;
    --md-sys-color-outline: #938F99;
    --md-sys-color-outline-variant: #49454F;
    --md-sys-color-shadow: #000000;
    --md-sys-color-inverse-surface: #E6E1E5;
    --md-sys-color-inverse-on-surface: #313033;
    --md-sys-color-inverse-primary: #6750A4;
    --md-sys-color-surface-dim: #141218; /* M3 Surface Tints for Dark */
    --md-sys-color-surface-bright: #3B383E;
    --md-sys-color-surface-container-lowest: #0F0D13;
    --md-sys-color-surface-container-low: #1D1B20;
    --md-sys-color-surface-container: #211F26;
    --md-sys-color-surface-container-high: #2B2931;
    --md-sys-color-surface-container-highest: #36343B;

    /* Layout specific variables for dark theme */
    --icon-bar-bg: var(--md-sys-color-surface-container-low);
    --chat-list-panel-bg: var(--md-sys-color-surface);
    --chat-area-bg: var(--md-sys-color-background);
    --header-bg: var(--md-sys-color-surface-container-high);
    --header-text-color: var(--md-sys-color-on-surface-variant);
    --input-bg: var(--md-sys-color-surface-container-highest);
    --input-border-color: var(--md-sys-color-outline);
    --input-focus-border-color: var(--md-sys-color-primary);
    --button-primary-bg: var(--md-sys-color-primary);
    --button-primary-text: var(--md-sys-color-on-primary);
    --button-danger-bg: var(--md-sys-color-error);
    --button-danger-text: var(--md-sys-color-on-error);

    /* Specific Status Colors (map to M3 roles for dark) */
    --pending-analyzed-bg: var(--md-sys-color-tertiary-container);
    --pending-analyzed-text: var(--md-sys-color-on-tertiary-container);
    --pending-analyzed-border: var(--md-sys-color-tertiary);

    --system-notification-bg: var(--md-sys-color-surface-container);
    --system-notification-text: var(--md-sys-color-on-surface-variant);
    --system-notification-border: var(--md-sys-color-outline-variant);
}

/* Basic body and HTML styling */
body {
    font-family: var(--font-family-sans);
    background-color: var(--md-sys-color-background);
    color: var(--md-sys-color-on-background);
    margin: 0;
    display: flex;
    min-height: 100vh;
    overflow-x: hidden;
}

.container {
    display: flex;
    width: 100%;
    max-width: 100%;
    margin: 0;
    background-color: var(--md-sys-color-surface);
    border-radius: 0;
    box-shadow: none;
    overflow: hidden;
    height: 100vh;
}

/* --- Icon Bar --- */
.icon-bar {
    width: 72px;
    background-color: var(--icon-bar-bg);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 16px 0; /* Vertical padding */
    flex-shrink: 0;
    box-shadow: 0 2px 4px -1px rgba(0,0,0,0.06), 0 4px 5px 0 rgba(0,0,0,0.06); /* M3 Elevation 2-dp */
    gap: 12px; /* Consistent gap between items */
}

.icon-bar-item {
    width: 56px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 16px; /* M3 large rounded corners */
    cursor: pointer;
    transition: background-color 0.2s ease;
    background-color: transparent; /* Default no background */
}

.icon-bar-icon {
    width: 28px;
    height: 28px;
    /* Default icon color for light theme (maps to --md-sys-color-on-surface-variant) */
    filter: invert(28%) sepia(8%) saturate(1148%) hue-rotate(205deg) brightness(90%) contrast(87%);
}

.icon-bar-item:hover {
    background-color: var(--md-sys-color-surface-container-high); /* Hover background */
}

.icon-bar-item.active {
    background-color: var(--md-sys-color-primary-container); /* Active background */
}

.icon-bar-item.active .icon-bar-icon {
    /* Active icon color for light theme (maps to --md-sys-color-on-primary-container) */
    filter: invert(9%) sepia(24%) saturate(6794%) hue-rotate(237deg) brightness(98%) contrast(103%);
}

/* User profile icon at the top - specific container if needed, or rely on .icon-bar-item */
.user-profile-icon-container .icon-bar-icon {
    /* Could have slightly different styling if needed, e.g. background for the image if not transparent */
}

/* Agent name at the bottom */
.icon-bar-agent-name {
    /* margin-top: auto; -- Handled by flex-grow spacers in HTML */
    padding: 8px;
    text-align: center;
    font-size: var(--md-sys-typescale-label-large-size);
    color: var(--md-sys-color-on-surface-variant);
    word-break: break-word; /* Ensure long names wrap */
}


/* Dark Theme adjustments for icons */
html[data-theme="dark"] .icon-bar-icon {
    /* Default icon color for dark theme (maps to --md-sys-color-on-surface-variant) */
    filter: invert(81%) sepia(10%) saturate(200%) hue-rotate(205deg) brightness(90%) contrast(87%);
}

html[data-theme="dark"] .icon-bar-item.active .icon-bar-icon {
    /* Active icon color for dark theme (maps to --md-sys-color-on-primary-container) */
    filter: invert(85%) sepia(23%) saturate(3800%) hue-rotate(200deg) brightness(108%) contrast(100%);
}

/* --- Chat List Panel --- */
.chat-list-panel {
    width: 320px; /* M3 recommended panel width */
    background-color: var(--chat-list-panel-bg);
    border-right: 1px solid var(--md-sys-color-outline-variant);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
}
/* Header for Chat List Panel (was .sidebar-header) */
.chat-list-panel-header { /* Assuming you might add a dedicated header div */
    padding: var(--header-padding-y) 1rem;
    background-color: var(--header-bg);
    color: var(--header-text-color);
    font-weight: var(--md-sys-typescale-title-medium-font-weight);
    font-size: var(--md-sys-typescale-title-medium-size);
    text-align: center;
    flex-shrink: 0;
    min-height: var(--header-height);
    box-sizing: border-box;
    border-bottom: 1px solid var(--md-sys-color-outline-variant);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.sidebar-search { /* Search bar within chat list panel */
    padding: 12px 16px;
    border-bottom: 1px solid var(--md-sys-color-outline-variant);
    flex-shrink: 0;
    background-color: var(--chat-list-panel-bg); /* Ensure it matches panel */
}
.sidebar-search input {
    width: 100%;
    padding: 10px 16px; /* M3 text field padding */
    background-color: var(--input-bg);
    color: var(--md-sys-color-on-surface);
    border: 1px solid var(--input-border-color);
    border-radius: 16px; /* M3 text field corner radius */
    font-size: var(--md-sys-typescale-body-large-size);
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
.sidebar-search input:focus {
    border-color: var(--input-focus-border-color);
    box-shadow: 0 0 0 1px var(--input-focus-border-color); /* Focus ring */
}
.sidebar-search input::placeholder {
    color: var(--md-sys-color-on-surface-variant);
}

.chat-list-items {
    flex-grow: 1;
    overflow-y: auto;
    background-color: var(--chat-list-panel-bg);
}
.chat-item {
    padding: 12px 16px;
    border-bottom: 1px solid var(--md-sys-color-outline-variant);
    cursor: pointer;
    transition: background-color 0.2s ease;
}
.chat-item:hover {
    background-color: var(--md-sys-color-surface-container-high);
}
.chat-item.active {
    background-color: var(--md-sys-color-primary-container);
    /* border-left: 4px solid var(--md-sys-color-primary); Remove old border style */
    /* padding-left: calc(1rem - 4px); */
}
.chat-item.active .chat-item-name {
    color: var(--md-sys-color-on-primary-container);
}
.chat-item.active .chat-item-sector,
.chat-item.active .chat-item-preview,
.chat-item.active .chat-item-timestamp,
.chat-item.active .chat-item-id {
    color: var(--md-sys-color-on-primary-container);
    opacity: 0.8;
}


.chat-item-details { display: flex; align-items: center; }
.chat-item-profile-pic {
    width: 40px; height: 40px; border-radius: 50%;
    margin-right: 12px;
    background-color: var(--md-sys-color-secondary-container);
    color: var(--md-sys-color-on-secondary-container);
    display: flex; align-items: center; justify-content: center; font-weight: 500;
    object-fit: cover; flex-shrink: 0;
}
.chat-item-info { flex-grow: 1; overflow: hidden; display: flex; flex-direction: column; }
.chat-item-name-status { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 2px; }
.chat-item-name {
    font-weight: var(--md-sys-typescale-title-medium-font-weight);
    font-size: var(--md-sys-typescale-title-medium-size);
    color: var(--md-sys-color-on-surface);
    white-space: normal; word-break: break-word; margin-right: 8px;
}
.chat-item-id {
    font-size: 0.75rem;
    color: var(--md-sys-color-on-surface-variant);
    display: block;
}
.chat-item-sector, .chat-item-preview, .chat-item-timestamp {
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--md-sys-color-on-surface-variant);
    margin-top: 2px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.chat-item-preview { font-style: normal; } /* Remove italic for M3 */

.chat-item .take-chat-button {
    margin-top: 8px; padding: 6px 12px;
    background-color: var(--md-sys-color-primary);
    color: var(--md-sys-color-on-primary);
    border: none; border-radius: 16px; /* M3 button shape */
    cursor: pointer; font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-font-weight);
    transition: background-color 0.2s ease;
    align-self: flex-start; display: inline-flex; align-items: center; gap: 6px;
}
.chat-item .take-chat-button:hover { background-color: var(--md-sys-color-primary-container); color: var(--md-sys-color-on-primary-container); }
.chat-item .take-chat-button img { width: 1rem; height: 1rem; filter: brightness(0) invert(1); }
.chat-item .take-chat-button:hover img { filter: brightness(0) invert(10%) sepia(80%) saturate(5000%) hue-rotate(250deg); }


.chat-item.has-new-message { /* No specific border, rely on font weight or dot indicator if added */ }
.chat-item.has-new-message .chat-item-name { font-weight: 700; /* Bold */ }
.chat-item.has-new-message.pending-analyzed .chat-item-name { color: var(--pending-analyzed-text); }
.chat-item.auto-released .chat-item-name { color: var(--md-sys-color-error); }

.chat-status-indicator {
    padding: 4px 10px; border-radius: 8px; /* M3 chip-like style */
    font-size: 0.7rem; font-weight: 500; text-transform: uppercase;
    letter-spacing: 0.02em; white-space: nowrap; flex-shrink: 0;
}
.chat-status-indicator.active { background-color: var(--md-sys-color-primary-container); color: var(--md-sys-color-on-primary-container); }
.chat-status-indicator.pending { background-color: var(--md-sys-color-tertiary-container); color: var(--md-sys-color-on-tertiary-container); }
.chat-status-indicator.closed { background-color: var(--md-sys-color-surface-variant); color: var(--md-sys-color-on-surface-variant); }
.chat-status-indicator.other-attendant { background-color: var(--md-sys-color-secondary-container); color: var(--md-sys-color-on-secondary-container); }
.chat-status-indicator.released { background-color: var(--md-sys-color-error-container); color: var(--md-sys-color-on-error-container); }
.chat-status-indicator.pending-analyzed { background-color: var(--pending-analyzed-bg); color: var(--pending-analyzed-text); }

/* --- Chat Area --- */
.chat-area {
    flex-grow: 1; display: flex; flex-direction: column;
    height: 100%; overflow: hidden;
    background-color: var(--chat-area-bg);
}

.chat-header {
    background-color: var(--header-bg);
    color: var(--header-text-color);
    padding: var(--header-padding-y) 1rem;
    font-size: var(--header-font-size);
    font-weight: var(--md-sys-typescale-title-medium-font-weight);
    display: flex; justify-content: space-between; align-items: center;
    flex-shrink: 0; border-bottom: 1px solid var(--md-sys-color-outline-variant);
    min-height: var(--header-height); box-sizing: border-box;
    box-shadow: 0 1px 2px 0 rgba(0,0,0,0.03), 0 1px 3px 1px rgba(0,0,0,0.03); /* M3 Elevation 1-dp like */
}
.chat-header-title { display: flex; align-items: center; gap: 0.75rem; }
.chat-header-title img {
    width: 1.75rem; height: 1.75rem; opacity: 0.7;
    /* Consider direct SVG fill via JS for M3 theming */
    filter: invert(30%) sepia(10%) saturate(500%) hue-rotate(180deg) brightness(80%) contrast(100%);
}
html[data-theme="dark"] .chat-header-title img {
    filter: invert(80%) sepia(10%) saturate(100%) hue-rotate(180deg) brightness(100%) contrast(90%);
}

.chat-header .end-chat-button {
    padding: 8px 16px;
    background-color: var(--button-danger-bg);
    color: var(--button-danger-text);
    border: none; border-radius: 20px; /* M3 full rounded button */
    cursor: pointer; font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-font-weight);
    transition: background-color 0.2s ease;
    display: inline-flex; align-items: center; gap: 8px;
    box-shadow: 0 1px 2px 0 var(--md-sys-color-shadow); /* M3 Elevation 1-dp */
}
.chat-header .end-chat-button:hover { background-color: var(--md-sys-color-error-container); color: var(--md-sys-color-on-error-container); }
.chat-header .end-chat-button svg { width: 1.125rem; height: 1.125rem; }


.chat-messages {
    flex-grow: 1; padding: 1rem; overflow-y: auto;
    display: flex; flex-direction: column;
    background-color: var(--chat-area-bg); /* Match chat area background */
    gap: 0.75rem;
}
.message {
    padding: 0.75rem 1rem; /* M3 standard padding */
    border-radius: 16px; /* M3 corner radius */
    max-width: 75%; word-wrap: break-word; position: relative;
    line-height: 1.5; font-size: var(--md-sys-typescale-body-large-size);
    box-shadow: 0 1px 2px 0 rgba(0,0,0,0.08); /* Subtle shadow for messages */
}
.message.client {
    background-color: var(--md-sys-color-surface-container-high); /* Client bubble */
    color: var(--md-sys-color-on-surface);
    align-self: flex-start;
    border-top-right-radius: 16px; border-bottom-right-radius: 16px;
    border-top-left-radius: 4px; border-bottom-left-radius: 4px; /* M3 asymmetric radius */
}
.message.agent {
    background-color: var(--md-sys-color-primary-container); /* Agent bubble */
    color: var(--md-sys-color-on-primary-container);
    align-self: flex-end;
    border-top-left-radius: 16px; border-bottom-left-radius: 16px;
    border-top-right-radius: 4px; border-bottom-right-radius: 4px; /* M3 asymmetric radius */
}
.message-info {
    font-size: 0.7rem; margin-top: 4px; display: block;
    opacity: 0.8;
}
.message.client .message-info { text-align: left; color: var(--md-sys-color-on-surface-variant); }
.message.agent .message-info { text-align: right; color: var(--md-sys-color-on-primary-container); }

.message.system-notification-message {
    background-color: var(--system-notification-bg);
    color: var(--system-notification-text);
    align-self: center; font-style: italic; font-size: 0.8rem;
    max-width: 90%; text-align: center;
    border: 1px dashed var(--system-notification-border);
    box-shadow: none; margin-top: 0.5rem; margin-bottom: 0.5rem;
    border-radius: 8px;
}

.message .media-content { max-width: 100%; height: auto; display: block; margin-top: 0.5rem; border-radius: 8px; }
.message .media-content.image { max-height: 250px; object-fit: contain; }
.message .media-content.document {
    display: inline-flex; align-items: center; gap: 0.5rem;
    background-color: var(--md-sys-color-surface-container-highest);
    padding: 0.5rem 0.75rem; border-radius: 8px;
    color: var(--md-sys-color-primary); text-decoration: none;
    font-weight: 500; transition: background-color 0.2s;
    font-size: var(--md-sys-typescale-label-large-size);
}
.message .media-content.document:hover { background-color: var(--md-sys-color-surface-dim); }
.message .media-content.document img { width: 1.125rem; height: 1.125rem; filter: invert(39%) sepia(98%) saturate(1789%) hue-rotate(195deg) brightness(100%) contrast(101%); }


.typing-indicator {
    font-style: italic; color: var(--md-sys-color-on-surface-variant);
    padding: 0 1rem 0.5rem; font-size: var(--md-sys-typescale-body-medium-size);
}

.chat-input-area {
    display: flex; padding: 0.75rem 1rem;
    border-top: 1px solid var(--md-sys-color-outline-variant);
    flex-shrink: 0; background-color: var(--md-sys-color-surface-container-low); /* Slightly different from chat area bg */
    align-items: center; gap: 0.75rem;
}
.chat-input-area input[type="text"] {
    flex-grow: 1; padding: 12px 16px; /* M3 text field padding */
    background-color: var(--input-bg);
    color: var(--md-sys-color-on-surface);
    border: 1px solid var(--input-border-color);
    border-radius: 20px; /* M3 text field full radius */
    font-size: var(--md-sys-typescale-body-large-size);
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
.chat-input-area input[type="text"]:focus {
    border-color: var(--input-focus-border-color);
    box-shadow: 0 0 0 1px var(--input-focus-border-color);
}
.chat-input-area input[type="text"]::placeholder {
    color: var(--md-sys-color-on-surface-variant);
}

.chat-input-area button { /* Send button */
    padding: 10px 20px; /* M3 button padding */
    background-color: var(--button-primary-bg);
    color: var(--button-primary-text);
    border: none; border-radius: 20px; /* M3 full rounded button */
    cursor: pointer; font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-font-weight);
    transition: background-color 0.2s ease, box-shadow 0.2s ease;
    display: inline-flex; align-items: center; gap: 8px;
    box-shadow: 0 1px 2px 0 var(--md-sys-color-shadow); /* M3 Elevation 1-dp */
}
.chat-input-area button:hover {
    background-color: var(--md-sys-color-primary-container);
    color: var(--md-sys-color-on-primary-container);
    box-shadow: 0 2px 4px -1px var(--md-sys-color-shadow); /* M3 Elevation 2-dp */
}
.chat-input-area button svg { width: 1.125rem; height: 1.125rem; }

.chat-input-area .upload-button { /* Attachment button - M3 Icon Button style */
    padding: 8px; background-color: transparent;
    color: var(--md-sys-color-on-surface-variant); border: none;
    border-radius: 50%; /* M3 icon button is circular */
    cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease;
    display: inline-flex; align-items: center; justify-content: center;
}
.chat-input-area .upload-button:hover {
    background-color: var(--md-sys-color-surface-container-highest);
    color: var(--md-sys-color-primary);
}
.chat-input-area .upload-button img { /* Icon for upload button */
    width: 1.5rem; height: 1.5rem;
    /* Default icon color, should be updated to use M3 icon colors */
    filter: invert(40%) sepia(10%) saturate(500%) hue-rotate(180deg) brightness(100%) contrast(90%);
}
.chat-input-area .upload-button:hover img {
    /* Primary color for icon on hover */
    filter: invert(39%) sepia(98%) saturate(1789%) hue-rotate(195deg) brightness(100%) contrast(101%);
}
html[data-theme="dark"] .chat-input-area .upload-button img {
    filter: invert(80%) sepia(10%) saturate(100%) hue-rotate(180deg) brightness(100%) contrast(90%);
}
html[data-theme="dark"] .chat-input-area .upload-button:hover img {
    filter: invert(80%) sepia(50%) saturate(5000%) hue-rotate(200deg) brightness(100%) contrast(100%);
}

.chat-input-area input[type="file"] { display: none; }

.no-chat-selected {
    flex-grow: 1; display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    font-size: var(--md-sys-typescale-title-medium-size);
    color: var(--md-sys-color-on-surface-variant);
    text-align: center; padding: 2rem;
    background-color: var(--chat-area-bg);
}
.no-chat-selected img {
    width: 4rem; height: 4rem; margin-bottom: 1rem;
    opacity: 0.5;
    /* M3 themed icon for placeholder */
    filter: invert(50%) sepia(10%) saturate(500%) hue-rotate(180deg) brightness(100%) contrast(90%);
}
html[data-theme="dark"] .no-chat-selected img {
    filter: invert(80%) sepia(10%) saturate(100%) hue-rotate(180deg) brightness(70%) contrast(90%);
}


/* Connection Status Indicator */
.connection-status {
    position: fixed; bottom: 1rem; right: 1rem;
    padding: 8px 16px; border-radius: 16px; /* M3 chip style */
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-font-weight);
    box-shadow: 0 2px 5px 1px var(--md-sys-color-shadow); /* M3 Elevation 3-dp */
    z-index: 50; transition: opacity 0.3s ease, background-color 0.3s ease;
}
.connection-status.connected { background-color: var(--md-sys-color-primary-container); color: var(--md-sys-color-on-primary-container); }
.connection-status.connecting { background-color: var(--md-sys-color-tertiary-container); color: var(--md-sys-color-on-tertiary-container); }
.connection-status.disconnected { background-color: var(--md-sys-color-error-container); color: var(--md-sys-color-on-error-container); }

/* Alert Modal */
.alert-modal {
    position: fixed; top: 1.25rem; left: 50%; transform: translateX(-50%);
    padding: 12px 20px; border-radius: 12px; /* M3 dialog like */
    box-shadow: 0 4px 8px 3px var(--md-sys-color-shadow); /* M3 Elevation 6-dp */
    z-index: 100; font-size: var(--md-sys-typescale-body-large-size);
    font-weight: 500; min-width: 280px; text-align: center;
    display: none; opacity: 0;
    transition: opacity 0.3s ease, top 0.3s ease;
}
.alert-modal.show { display: block; opacity: 1; top: 1.75rem; }
.alert-modal.error { background-color: var(--md-sys-color-error-container); color: var(--md-sys-color-on-error-container); border: 1px solid var(--md-sys-color-error); }
.alert-modal.success { background-color: var(--md-sys-color-primary-container); color: var(--md-sys-color-on-primary-container); border: 1px solid var(--md-sys-color-primary); }
.alert-modal.warning { background-color: var(--md-sys-color-tertiary-container); color: var(--md-sys-color-on-tertiary-container); border: 1px solid var(--md-sys-color-tertiary); }

.btn-icon { width: 1.25em; height: 1.25em; display: inline-block; vertical-align: middle; }

/* Scrollbar Styling */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: var(--md-sys-color-surface-container-low); border-radius: 4px; }
::-webkit-scrollbar-thumb { background: var(--md-sys-color-outline); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--md-sys-color-on-surface-variant); }

/* --- Media Queries for Responsiveness --- */
@media (min-width: 768px) {
    .container {
        max-width: 100%; /* Allow full width usage */
        margin: 0; /* No margin on desktop, use full screen */
        border-radius: 0; /* No border radius on desktop */
        box-shadow: none; /* No shadow on desktop */
        height: 100vh; /* Full viewport height */
    }

    /* .sidebar class was removed, styles moved to .icon-bar and .chat-list-panel */
    /* .chat-list-panel retains its desktop width defined above */

    .chat-area { height: 100%; }
    .message { max-width: 70%; }
}

/* Remove old sidebar tab styling */
.sidebar-tabs { display: none; }
